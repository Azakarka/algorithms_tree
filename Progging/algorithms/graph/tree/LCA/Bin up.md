Двоичные подъемы. Строим массив и считаем для каждого элемента его 2^k предок ну понятно в принципе


```
for(int i =1; i < k; i++){
	for(int j = 0; j < n; j++){
		up[i][j] = up[i -1][up[i - 1][j]];
	}
}
```